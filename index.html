<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="referrer" content="never">
    <title></title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/swiper/css/swiper.min.css">
    <script src="https://unpkg.com/swiper/js/swiper.min.js"> </script>
    <!--<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>-->
    <style>
    </style>
  </head>
  <body>
    <div id="root">
      <!--
        因为图片数据是异步获取，刚开始 length 是 0，做一遍初始化，
        当数据填充到列表的时候，再做一次初始化
        如果不设置key值，递归算法会拿上次的缓存，所以设置 key值为 图片数组的 长度
       -->
      <swiper :key="dataList.length">
        <div class="swiper-slide" v-for="data in dataList">
          {{ data }}
        </div>
      </swiper>
    </div>

    <script type="text/javascript">
      Vue.component('swiper', {
        template:
          `
            <div class="swiper-container a">
              <div class="swiper-wrapper">
                <slot></slot>
              </div>
              <div class="swiper-pagination"></div>
            </div>
          `
        ,
        mounted() {
          new Swiper('.a', {
            loop: true,
            pagination: {
              el: '.swiper-pagination'
            }
          })
        }

      })

      let vm = new Vue({
        el: '#root',
        data: {
          dataList: []
        },
        mounted() {
          setTimeout(() => {
            this.dataList = [111, 222, 333]
          }, 1000)
        }
      })


      /*
        解决的问题：swiper到底在何时初始化？
        思路：因为图片数据是异步获取，刚开始 length 是 0，做一遍初始化，
             当数据填充到列表的时候，再做一次初始化
             如果不设置key值，递归算法会拿上次的缓存，所以设置 key值为 图片数组的 长度

       */
    </script>
  </body>
</html>
